2020-05-17 12:30:05.904 +00:00 [INF] Configuring web host (RegistrationService.API)...
2020-05-17 12:30:07.785 +00:00 [INF] Starting web host (RegistrationService.API)...
2020-05-17 12:30:08.212 +00:00 [WRN] Overriding address(es) 'http://+:80'. Binding to endpoints defined in UseKestrel() instead.
2020-05-17 12:34:08.552 +00:00 [WRN] 'AddEntityFramework*' was called on the service provider, but 'UseInternalServiceProvider' wasn't called in the DbContext options configuration. Remove the 'AddEntityFramework*' call as in most cases it's not needed and might cause conflicts with other products and services registered in the same service provider.
2020-05-17 12:34:09.063 +00:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data, this mode should only be enabled during development.
2020-05-17 12:34:13.509 +00:00 [INF] -----Sending command: RegistrationCommand
2020-05-17 12:34:16.536 +00:00 [ERR] An exception was thrown while activating λ:MediatR.IPipelineBehavior`2[[RegistrationService.API.Application.Commands.RegistrationCommand, RegistrationService.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Boolean, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]][] -> RegistrationService.API.Application.Behaviors.TransactionBehaviour`2[[RegistrationService.API.Application.Commands.RegistrationCommand, RegistrationService.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Boolean, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]] -> RegistrationService.API.IntegrationEvents.RegistrationIntegrationEventService -> λ:iPas.Infrastructure.EventBus.Abstractions.IEventBus.
Autofac.Core.DependencyResolutionException: An exception was thrown while activating λ:MediatR.IPipelineBehavior`2[[RegistrationService.API.Application.Commands.RegistrationCommand, RegistrationService.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Boolean, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]][] -> RegistrationService.API.Application.Behaviors.TransactionBehaviour`2[[RegistrationService.API.Application.Commands.RegistrationCommand, RegistrationService.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Boolean, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]] -> RegistrationService.API.IntegrationEvents.RegistrationIntegrationEventService -> λ:iPas.Infrastructure.EventBus.Abstractions.IEventBus.
 ---> Microsoft.Azure.ServiceBus.UnauthorizedException: Put token failed. status-code: 401, status-description: ExpiredToken: The token is expired. Expiration time: '2020-05-17 13:34:16Z'.
   at Microsoft.Azure.ServiceBus.Amqp.AmqpSubscriptionClient.OnRemoveRuleAsync(String ruleName)
   at Microsoft.Azure.ServiceBus.SubscriptionClient.RemoveRuleAsync(String ruleName)
   at iPas.Infrastructure.EventBusServiceBus.EventBusServiceBus.RemoveDefaultRule() in C:\Users\dreck\source\repos\RegistrationService.Data\SimpleRegistrationService\iPas.Infrastructure.EventBusServiceBus\EventBusServiceBus.cs:line 197
   at iPas.Infrastructure.EventBusServiceBus.EventBusServiceBus..ctor(IServiceBusPersisterConnection serviceBusPersisterConnection, ILogger`1 logger, IEventBusSubscriptionsManager subsManager, String subscriptionClientName, ILifetimeScope autofac) in C:\Users\dreck\source\repos\RegistrationService.Data\SimpleRegistrationService\iPas.Infrastructure.EventBusServiceBus\EventBusServiceBus.cs:line 37
   at RegistrationService.API.CustomExtensionsMethods.<>c__DisplayClass3_0.<AddEventBus>b__0(IServiceProvider sp) in C:\Users\dreck\source\repos\RegistrationService.Data\SimpleRegistrationService\RegistrationService.API\Startup.cs:line 192
   at Autofac.Extensions.DependencyInjection.AutofacRegistration.<>c__DisplayClass3_0.<Register>b__0(IComponentContext context, IEnumerable`1 parameters)
   at Autofac.Core.Activators.Delegate.DelegateActivator.ActivateInstance(IComponentContext context, IEnumerable`1 parameters)
   at Autofac.Core.Resolving.InstanceLookup.CreateInstance(IEnumerable`1 parameters)
   --- End of inner exception stack trace ---
   at Autofac.Core.Resolving.InstanceLookup.CreateInstance(IEnumerable`1 parameters)
   at Autofac.Core.Resolving.InstanceLookup.Execute()
   at Autofac.Core.Resolving.ResolveOperation.GetOrCreateInstance(ISharingLifetimeScope currentOperationScope, ResolveRequest request)
   at Autofac.Core.Resolving.ResolveOperation.ResolveComponent(ResolveRequest request)
   at Autofac.Core.Resolving.ResolveOperation.Execute(ResolveRequest request)
   at Autofac.Core.Lifetime.LifetimeScope.ResolveComponent(ResolveRequest request)
   at Autofac.ResolutionExtensions.TryResolveService(IComponentContext context, Service service, IEnumerable`1 parameters, Object& instance)
   at Autofac.ResolutionExtensions.TryResolve(IComponentContext context, Type serviceType, Object& instance)
   at RegistrationService.API.Infrastructure.AutofacModules.MediatorModule.<>c__DisplayClass0_0.<Load>b__1(Type t) in C:\Users\dreck\source\repos\RegistrationService.Data\SimpleRegistrationService\RegistrationService.API\Infrastructure\AutofacModules\MediatorModule.cs:line 30
   at MediatR.ServiceFactoryExtensions.GetInstances[T](ServiceFactory factory)
   at MediatR.Internal.RequestHandlerWrapperImpl`2.Handle(IRequest`1 request, CancellationToken cancellationToken, ServiceFactory serviceFactory)
   at MediatR.Mediator.Send[TResponse](IRequest`1 request, CancellationToken cancellationToken)
   at RegistrationService.API.Controllers.RegistrationController.Registration(Adt dto) in C:\Users\dreck\source\repos\RegistrationService.Data\SimpleRegistrationService\RegistrationService.API\Controllers\RegistrationController.cs:line 104
   at lambda_method(Closure , Object )
   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2020-05-17 13:13:59.588 +00:00 [INF] Configuring web host (RegistrationService.API)...
2020-05-17 13:14:00.536 +00:00 [INF] Starting web host (RegistrationService.API)...
2020-05-17 13:14:00.846 +00:00 [WRN] Overriding address(es) 'http://+:80'. Binding to endpoints defined in UseKestrel() instead.
2020-05-17 13:14:58.981 +00:00 [WRN] 'AddEntityFramework*' was called on the service provider, but 'UseInternalServiceProvider' wasn't called in the DbContext options configuration. Remove the 'AddEntityFramework*' call as in most cases it's not needed and might cause conflicts with other products and services registered in the same service provider.
2020-05-17 13:14:59.377 +00:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data, this mode should only be enabled during development.
2020-05-17 13:19:55.499 +00:00 [INF] -----Sending command: RegistrationCommand
2020-05-17 13:19:57.687 +00:00 [ERR] An exception was thrown while activating λ:MediatR.IPipelineBehavior`2[[RegistrationService.API.Application.Commands.RegistrationCommand, RegistrationService.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Boolean, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]][] -> RegistrationService.API.Application.Behaviors.TransactionBehaviour`2[[RegistrationService.API.Application.Commands.RegistrationCommand, RegistrationService.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Boolean, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]] -> RegistrationService.API.IntegrationEvents.RegistrationIntegrationEventService -> λ:iPas.Infrastructure.EventBus.Abstractions.IEventBus.
Autofac.Core.DependencyResolutionException: An exception was thrown while activating λ:MediatR.IPipelineBehavior`2[[RegistrationService.API.Application.Commands.RegistrationCommand, RegistrationService.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Boolean, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]][] -> RegistrationService.API.Application.Behaviors.TransactionBehaviour`2[[RegistrationService.API.Application.Commands.RegistrationCommand, RegistrationService.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Boolean, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]] -> RegistrationService.API.IntegrationEvents.RegistrationIntegrationEventService -> λ:iPas.Infrastructure.EventBus.Abstractions.IEventBus.
 ---> Microsoft.Azure.ServiceBus.UnauthorizedException: Put token failed. status-code: 401, status-description: ExpiredToken: The token is expired. Expiration time: '2020-05-17 14:19:57Z'.
   at Microsoft.Azure.ServiceBus.Amqp.AmqpSubscriptionClient.OnRemoveRuleAsync(String ruleName)
   at Microsoft.Azure.ServiceBus.SubscriptionClient.RemoveRuleAsync(String ruleName)
   at iPas.Infrastructure.EventBusServiceBus.EventBusServiceBus.RemoveDefaultRule() in C:\Users\dreck\source\repos\RegistrationService.Data\SimpleRegistrationService\iPas.Infrastructure.EventBusServiceBus\EventBusServiceBus.cs:line 197
   at iPas.Infrastructure.EventBusServiceBus.EventBusServiceBus..ctor(IServiceBusPersisterConnection serviceBusPersisterConnection, ILogger`1 logger, IEventBusSubscriptionsManager subsManager, String subscriptionClientName, ILifetimeScope autofac) in C:\Users\dreck\source\repos\RegistrationService.Data\SimpleRegistrationService\iPas.Infrastructure.EventBusServiceBus\EventBusServiceBus.cs:line 37
   at RegistrationService.API.CustomExtensionsMethods.<>c__DisplayClass3_0.<AddEventBus>b__0(IServiceProvider sp) in C:\Users\dreck\source\repos\RegistrationService.Data\SimpleRegistrationService\RegistrationService.API\Startup.cs:line 192
   at Autofac.Extensions.DependencyInjection.AutofacRegistration.<>c__DisplayClass3_0.<Register>b__0(IComponentContext context, IEnumerable`1 parameters)
   at Autofac.Core.Activators.Delegate.DelegateActivator.ActivateInstance(IComponentContext context, IEnumerable`1 parameters)
   at Autofac.Core.Resolving.InstanceLookup.CreateInstance(IEnumerable`1 parameters)
   --- End of inner exception stack trace ---
   at Autofac.Core.Resolving.InstanceLookup.CreateInstance(IEnumerable`1 parameters)
   at Autofac.Core.Resolving.InstanceLookup.Execute()
   at Autofac.Core.Resolving.ResolveOperation.GetOrCreateInstance(ISharingLifetimeScope currentOperationScope, ResolveRequest request)
   at Autofac.Core.Resolving.ResolveOperation.ResolveComponent(ResolveRequest request)
   at Autofac.Core.Resolving.ResolveOperation.Execute(ResolveRequest request)
   at Autofac.Core.Lifetime.LifetimeScope.ResolveComponent(ResolveRequest request)
   at Autofac.ResolutionExtensions.TryResolveService(IComponentContext context, Service service, IEnumerable`1 parameters, Object& instance)
   at Autofac.ResolutionExtensions.TryResolve(IComponentContext context, Type serviceType, Object& instance)
   at RegistrationService.API.Infrastructure.AutofacModules.MediatorModule.<>c__DisplayClass0_0.<Load>b__1(Type t) in C:\Users\dreck\source\repos\RegistrationService.Data\SimpleRegistrationService\RegistrationService.API\Infrastructure\AutofacModules\MediatorModule.cs:line 30
   at MediatR.ServiceFactoryExtensions.GetInstances[T](ServiceFactory factory)
   at MediatR.Internal.RequestHandlerWrapperImpl`2.Handle(IRequest`1 request, CancellationToken cancellationToken, ServiceFactory serviceFactory)
   at MediatR.Mediator.Send[TResponse](IRequest`1 request, CancellationToken cancellationToken)
   at RegistrationService.API.Controllers.RegistrationController.Registration(Adt dto) in C:\Users\dreck\source\repos\RegistrationService.Data\SimpleRegistrationService\RegistrationService.API\Controllers\RegistrationController.cs:line 104
   at lambda_method(Closure , Object )
   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
